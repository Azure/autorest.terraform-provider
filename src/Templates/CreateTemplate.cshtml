@using AutoRest.Core
@using AutoRest.Terraform
@using AutoRest.Terraform.Templates
@using System.Collections.Generic
@using System.Linq
@inherits TfProviderTemplateBase<CreateGenerator>

func @(Model.FunctionName)(d *@(OtherModel<ImportsGenerator>().Reference("schema")).ResourceData, meta interface{}) error {
@{
    Indentation.Indent();

@:@(Indentation)client := meta.(* ArmClient).@Model.GoSDKClientName
@:@(Indentation)ctx := meta.(* ArmClient).StopContext
@EmptyLine

    foreach (var invocation in Model.Invocations)
    {
        var fieldDefs = new Stack<IDictionary<string, string>>();
        fieldDefs.Push(new Dictionary<string, string>());
        foreach (var arg in invocation.Arguments)
        {
@:@(Include<FieldsToSDKSubTemplate, (GoSDKTypedData, IEnumerable<GoSDKNonTerminalTypes>, string, Stack<IDictionary<string, string>>)>((arg, arg.GoType.Chain, string.Empty, fieldDefs)))
        }

@EmptyLine
@:// Call the function with parameters, and returns response
@EmptyLine

        fieldDefs.Clear();
        fieldDefs.Push(new Dictionary<string, string>());
        foreach (var resp in invocation.Responses)
        {
@:@(Include<SDKToFieldsSubTemplate, (GoSDKTypedData, IEnumerable<GoSDKNonTerminalTypes>, string, Stack<IDictionary<string, string>>)>((resp, resp.GoType.Chain, "response.", fieldDefs)))
        }
    }

    Indentation.Outdent();
}
}
@EmptyLine